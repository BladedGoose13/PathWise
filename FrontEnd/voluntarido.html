<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PathWise | Comunidad Â· Voluntariado</title>
  <link rel="stylesheet" href="voluntariado.css">
</head>
<body>
  <div class="app">
    <!-- SIDEBAR IZQUIERDA PRINCIPAL -->
    <aside class="sidebar">
      <div class="sidebar-logo">
        <img src="Logo.png" alt="PathWise" />
      </div>

      <nav class="sidebar-nav">
        <a href="nuevoini.html" class="nav-item nav-item--simple nav-item--active">Inicio</a>
        <a href="clases.html" class="nav-item nav-item--simple">Clase</a>
        <a href="oportunidades.html" class="nav-item nav-item--simple">AdmisiÃ³n</a>
        <a href="becas.html" class="nav-item nav-item--simple">Becas</a>

        <button type="button" id="community-toggle" class="nav-item nav-item--group">
          <span>Community</span>
          <span class="nav-chevron">â–¾</span>
        </button>

        <div id="community-group" class="nav-sub nav-sub--open">
          <a href="Proyectos.html" class="nav-sub-item">Proyectos</a>
          <a href="voluntarido.html" class="nav-sub-item">Voluntariado</a>
          <a href="foro.html" class="nav-sub-item nav-sub-item--active">Foro</a>
        </div>
      </nav>

      <div class="sidebar-footer">
        <div class="user-mini">
          <div class="user-avatar">K</div>
          <div class="user-meta">
            <div class="user-name">Karla</div>
            <div class="user-tag">@usuario</div>
          </div>
        </div>
        <button class="logout-btn">Cerrar sesiÃ³n</button>
      </div>
    </aside>

</aside>


    <!-- CONTENIDO PRINCIPAL -->
    <main class="main">
      <header class="forum-header">
        <div class="forum-title">
          <h1>Voluntariado</h1>
        </div>

        <div class="forum-subcopy">
          Descubre oportunidades para ayudar, cumplir tu servicio social y sumar experiencia real
          mientras conectas con causas que te importan.
        </div>

        <div class="city-filter">
          <span class="city-label">Ciudad:</span>
          <button class="city-pill city-pill--active" data-city="Puebla">Puebla</button>
          <button class="city-pill" data-city="CDMX">CDMX</button>
          <button class="city-pill" data-city="Monterrey">Monterrey</button>
          <button class="city-pill" data-city="Guadalajara">Guadalajara</button>
        </div>
      </header>

      <div class="forum-body">
        <!-- COLUMNA IZQUIERDA: LISTA DE OPORTUNIDADES -->
        <section class="friends-column">
          <div class="friends-card">
            <div class="friends-header">
              <span class="friends-title">Oportunidades</span>
              <span class="friends-subtitle">
                Elige una opciÃ³n para ver los detalles y reseÃ±as.
              </span>
            </div>

            <div class="friends-search">
              <span class="search-icon"></span>
              <input
                type="text"
                id="search-input"
                placeholder="Buscar por nombre, causa o instituciÃ³n..."
              />
            </div>

            <div class="friends-list volunteer-opportunities" id="opportunity-list">
              <!-- La lista se genera dinÃ¡micamente con JS -->
            </div>
          </div>
        </section>

        <!-- COLUMNA CENTRAL: DETALLE DE LA OPORTUNIDAD -->
        <section class="chat-column">
          <article class="chat-card volunteer-detail-card">
            <div class="chat-header volunteer-header">
              <div>
                <div class="chat-channel-label">Voluntariado seleccionado</div>
                <div class="chat-channel-name" id="vol-title">Eco-limpieza en campus</div>
                <div class="chat-channel-meta" id="vol-meta">
                  Puebla Â· Presencial Â· Servicio social vÃ¡lido Â· 25 lugares
                </div>
              </div>

              <div class="rating-chip">
                <span class="rating-stars" id="vol-rating-stars">â˜…â˜…â˜…â˜…â˜…</span>
                <span class="rating-score" id="vol-rating-score">4.8</span>
                <span class="rating-count" id="vol-rating-count">Â· 32 reseÃ±as</span>
              </div>
            </div>

            <div class="vol-detail-layout">
              <div class="vol-detail-image">
                <img id="vol-image" 
                src="ecocampus.png" 
                alt="Imagen del voluntariado">
              </div>

              <div class="vol-detail-info">
                <h3 class="vol-section-title">Requisitos</h3>
                <ul class="vol-checklist" id="vol-requirements">
                  <!-- Se llena con JS -->
                </ul>

                <h3 class="vol-section-title">Â¿QuÃ© vas a hacer?</h3>
                <p class="vol-description" id="vol-description">
                  <!-- Se llena con JS -->
                </p>

                <div class="vol-cta-row">
                  <button class="primary-btn primary-btn--small">
                    Postularme
                  </button>
                  <button type="button" class="secondary-btn">
                    Guardar para despuÃ©s
                  </button>
                </div>
              </div>
            </div>

            <div class="vol-quick-cards">
              <div class="vol-quick-card">
                <div class="vol-quick-title">Notas rÃ¡pidas</div>
                <p class="vol-quick-text" id="vol-notes">
                  <!-- Se llena con JS -->
                </p>
              </div>

              <div class="vol-quick-card">
                <div class="vol-quick-title">Resumen de reseÃ±as</div>
                <p class="vol-quick-text" id="vol-summary">
                  <!-- Se llena con JS -->
                </p>
              </div>
            </div>
          </article>
        </section>

        <!-- COLUMNA DERECHA: RESEÃ‘AS / COMENTARIOS -->
        <section class="friends-column volunteer-comments-column">
          <div class="friends-card volunteer-comments-card">
            <div class="friends-header">
              <span class="friends-title">ReseÃ±as de estudiantes</span>
              <span class="friends-subtitle">
                Personas que ya fueron cuentan su experiencia.
              </span>
            </div>

            <div class="vol-comments-list" id="vol-comments">
              <!-- Se llena con JS -->
            </div>

            <form class="vol-comment-form" id="comment-form">
              <label for="comment-text">Deja tu reseÃ±a</label>

              <div class="vol-comment-rating-input">
                <span>Tu puntuaciÃ³n:</span>
                <select id="comment-rating">
                  <option value="5">â­ 5 - Me encantÃ³</option>
                  <option value="4">â­ 4 - Muy bueno</option>
                  <option value="3">â­ 3 - EstÃ¡ bien</option>
                  <option value="2">â­ 2 - PodrÃ­a mejorar</option>
                  <option value="1">â­ 1 - No lo repetirÃ­a</option>
                </select>
              </div>

              <textarea
                id="comment-text"
                placeholder="Cuenta cÃ³mo te fue en esta experiencia..."
              ></textarea>

              <button type="submit" class="primary-btn primary-btn--small">
                Publicar reseÃ±a
              </button>
            </form>
          </div>
        </section>
      </div>
    </main>
  </div>

  <script>
    // ===== DATOS DE OPORTUNIDADES POR CIUDAD =====
const volunteerData = {
  "Puebla": [
    {
      id: "p1",
      initials: "EC",
      name: "Eco-limpieza en campus",
      short: "Puebla Â· SÃ¡bados Â· 3 hrs",
      meta: "Puebla Â· Presencial Â· Servicio social vÃ¡lido Â· 25 lugares",
      rating: 4.8,
      ratingCount: 32,
      image: "ecocampus.png",         // ğŸ‘ˆ NOMBRE EXACTO DE TU FLYER
      requirements: [
        "Ser estudiante de preparatoria o universidad.",
        "Disponibilidad mÃ­nima de 3 horas los sÃ¡bados por la maÃ±ana.",
        "Registrar tus horas en PathWise para que cuenten como servicio.",
        "Asistir a una inducciÃ³n de 30 minutos en lÃ­nea."
      ],
      description:
        "ApoyarÃ¡s en jornadas de limpieza dentro y alrededor del campus, separando residuos, levantando basura y participando en campaÃ±as de sensibilizaciÃ³n con otros estudiantes.",
      notes:
        "Lleva ropa cÃ³moda, bloqueador y una botella reutilizable. Te daremos guantes y bolsas recicladas.",
      summary:
        "Los estudiantes destacan el ambiente relajado, el buen equipo y que es muy fÃ¡cil completar horas de servicio social.",
      reviews: [
        {
          initial: "A",
          name: "Ana Â· Derecho",
          ratingText: "â˜…â˜…â˜…â˜…â˜… Â· 5.0",
          text: "Me encantÃ³, se arma muy buen ambiente y terminÃ© mis horas de servicio sin estrÃ©s."
        },
        {
          initial: "M",
          name: "Max Â· IngenierÃ­a",
          ratingText: "â˜…â˜…â˜…â˜…â˜† Â· 4.3",
          text: "Hay dÃ­as pesados si hace calor, pero vale la pena. ConocÃ­ a gente de otras carreras."
        }
      ]
    },
    {
      id: "p2",
      initials: "TM",
      name: "TutorÃ­as de matemÃ¡ticas",
      short: "Puebla Â· Entre semana Â· 2 hrs",
      meta: "Puebla Â· HÃ­brido Â· Servicio social vÃ¡lido Â· 15 lugares",
      rating: 4.9,
      ratingCount: 18,
      image: "tutorias-mate.png",     // ğŸ‘ˆ crea este archivo / o cambia el nombre
      requirements: [
        "Promedio mÃ­nimo de 80 en matemÃ¡ticas.",
        "Compromiso de asistir al menos 4 semanas seguidas.",
        "Gusto por explicar y trabajar con alumnos de secundaria."
      ],
      description:
        "DarÃ¡s tutorÃ­as de regularizaciÃ³n a estudiantes de secundaria que necesitan apoyo en Ã¡lgebra y geometrÃ­a bÃ¡sica, de forma presencial y en lÃ­nea.",
      notes:
        "Ideal si te gustan los nÃºmeros y quieres practicar habilidades de comunicaciÃ³n.",
      summary:
        "Los comentarios resaltan que es una forma ligera de acumular horas y reforzar lo que ya sabes.",
      reviews: [
        {
          initial: "L",
          name: "Luis Â· IngenierÃ­a Industrial",
          ratingText: "â˜…â˜…â˜…â˜…â˜… Â· 5.0",
          text: "SentÃ­ que realmente ayudÃ© a los chavos. AdemÃ¡s reforcÃ© temas que ya habÃ­a visto."
        }
      ]
    },
    {
      id: "p3",
      initials: "CC",
      name: "Comedor comunitario",
      short: "Puebla Â· Domingos Â· 4 hrs",
      meta: "Puebla Â· Presencial Â· Servicio social y voluntariado Â· 20 lugares",
      rating: 4.6,
      ratingCount: 21,
      image: "comedor-comunitario.png",
      requirements: [
        "Disponibilidad los domingos por la maÃ±ana.",
        "Actitud de servicio y trabajo en equipo.",
        "Uso obligatorio de cubrebocas y cofia durante la actividad."
      ],
      description:
        "AyudarÃ¡s en la preparaciÃ³n y servicio de alimentos para familias de la comunidad cercana, apoyando en cocina, servicio y logÃ­stica.",
      notes:
        "Es una actividad un poco mÃ¡s cansada fÃ­sicamente pero muy gratificante.",
      summary:
        "Las reseÃ±as mencionan el impacto directo con la comunidad y lo significativo que se siente la experiencia.",
      reviews: [
        {
          initial: "S",
          name: "SofÃ­a Â· Arquitectura",
          ratingText: "â˜…â˜…â˜…â˜…â˜† Â· 4.4",
          text: "Terminas cansada pero feliz. Ver a las familias agradecidas no tiene precio."
        }
      ]
    }
  ],

  "CDMX": [
    {
      id: "c1",
      initials: "FN",
      name: "FundaciÃ³n NiÃ±os con Futuro",
      short: "CDMX Â· Tardes entre semana",
      meta: "CDMX Â· Presencial Â· Apoyo escolar y lÃºdico Â· 18 lugares",
      rating: 4.9,
      ratingCount: 27,
      image: "fundacion-ninos.png",
      requirements: [
        "Carta de no antecedentes penales (puede ser digital).",
        "Asistir mÃ­nimo 1 vez por semana.",
        "Gusto por convivir con niÃ±as y niÃ±os."
      ],
      description:
        "RealizarÃ¡s actividades lÃºdicas y de apoyo escolar con niÃ±as y niÃ±os en situaciÃ³n vulnerable, en coordinaciÃ³n con el personal de la fundaciÃ³n.",
      notes:
        "Recomendable si te interesa psicologÃ­a, educaciÃ³n o trabajo social.",
      summary:
        "Las reseÃ±as resaltan el aprendizaje humano y la cercanÃ­a con las historias de los niÃ±os.",
      reviews: [
        {
          initial: "K",
          name: "Karen Â· PsicologÃ­a",
          ratingText: "â˜…â˜…â˜…â˜…â˜… Â· 5.0",
          text: "Te cambia la perspectiva totalmente. AprendÃ­ mÃ¡s de lo que enseÃ±Ã©."
        }
      ]
    },
    {
      id: "c2",
      initials: "TL",
      name: "Taller de lectura en primaria",
      short: "CDMX Â· SÃ¡bados por la maÃ±ana",
      meta: "CDMX Â· Presencial Â· Lectura y comprensiÃ³n Â· 10 lugares",
      rating: 4.7,
      ratingCount: 14,
      image: "taller-lectura.png",
      requirements: [
        "Gusto por la lectura.",
        "Habilidad bÃ¡sica para hablar frente a grupo.",
        "Llegar 15 minutos antes para preparar el material."
      ],
      description:
        "CoordinarÃ¡s pequeÃ±os cÃ­rculos de lectura con niÃ±as y niÃ±os de primaria, haciendo dinÃ¡micas para que entiendan y disfruten las historias.",
      notes:
        "Actividad tranquila, ideal si te gustan los libros y la expresiÃ³n oral.",
      summary:
        "Los estudiantes dicen que se siente como jugar mientras enseÃ±as.",
      reviews: [
        {
          initial: "R",
          name: "Rodrigo Â· ComunicaciÃ³n",
          ratingText: "â˜…â˜…â˜…â˜…â˜† Â· 4.5",
          text: "Es muy relajado y sales con buenas anÃ©cdotas. Recomendado."
        }
      ]
    },
    {
      id: "c3",
      initials: "HU",
      name: "Huerto urbano comunitario",
      short: "CDMX Â· Fines de semana Â· 3 hrs",
      meta: "CDMX Â· Presencial Â· Sustentabilidad Â· 12 lugares",
      rating: 4.8,
      ratingCount: 19,
      image: "huerto-urbano.png",
      requirements: [
        "No necesitas experiencia previa.",
        "DisposiciÃ³n a ensuciarte las manos (literal).",
        "Llevar gorra o sombrero."
      ],
      description:
        "ApoyarÃ¡s en el mantenimiento de un huerto urbano: siembra, riego, compostaje y talleres bÃ¡sicos para la comunidad.",
      notes:
        "Perfecto si te interesa el medio ambiente y quieres algo al aire libre.",
      summary:
        "ReseÃ±as mencionan que es terapÃ©utico y que se aprende mucho sobre plantas.",
      reviews: [
        {
          initial: "D",
          name: "Diego Â· BiotecnologÃ­a",
          ratingText: "â˜…â˜…â˜…â˜…â˜… Â· 5.0",
          text: "Me encantÃ³ estar al aire libre, sentÃ­ que descansaba de la rutina."
        }
      ]
    }
  ],

  "Monterrey": [
    {
      id: "m1",
      initials: "BA",
      name: "Banco de alimentos",
      short: "Monterrey Â· Flexible",
      meta: "Monterrey Â· Presencial Â· LogÃ­stica y empaquetado Â· 30 lugares",
      rating: 4.6,
      ratingCount: 25,
      image: "banco-alimentos.png",
      requirements: [
        "Capacidad para cargar cajas ligeras.",
        "Disponibilidad mÃ­nima de 2 horas por visita.",
        "Uso de tenis cerrados."
      ],
      description:
        "AyudarÃ¡s a clasificar y empacar alimentos que se donan a distintas comunidades y organizaciones.",
      notes:
        "Actividad dinÃ¡mica, ideal para ir en grupo con amigos.",
      summary:
        "Los estudiantes destacan que el tiempo pasa rÃ¡pido y se siente muy productivo.",
      reviews: [
        {
          initial: "M",
          name: "Mariana Â· AdministraciÃ³n",
          ratingText: "â˜…â˜…â˜…â˜…â˜† Â· 4.4",
          text: "Es cansado pero divertido, sobre todo si vas con amigos."
        }
      ]
    },
    {
      id: "m2",
      initials: "ST",
      name: "MentorÃ­as STEM para niÃ±as",
      short: "Monterrey Â· Entre semana Â· 2 hrs",
      meta: "Monterrey Â· HÃ­brido Â· MentorÃ­as Â· 16 lugares",
      rating: 4.9,
      ratingCount: 17,
      image: "mentorias-stem.png",
      requirements: [
        "Ser estudiante de alguna carrera STEM.",
        "Disponibilidad para sesiones virtuales y presenciales.",
        "InterÃ©s por inspirar a niÃ±as en ciencia y tecnologÃ­a."
      ],
      description:
        "DarÃ¡s mentorÃ­as y pequeÃ±as clases introductorias de ciencia, tecnologÃ­a o matemÃ¡ticas a niÃ±as de secundaria.",
      notes:
        "Buen complemento si buscas proyectos para tu CV en tecnologÃ­a.",
      summary:
        "Los comentarios resaltan lo emocionante que es ver a las niÃ±as interesarse por STEM.",
      reviews: [
        {
          initial: "F",
          name: "Fernanda Â· MecatrÃ³nica",
          ratingText: "â˜…â˜…â˜…â˜…â˜… Â· 5.0",
          text: "Me vi reflejada en ellas. SÃºper recomendado si quieres motivar a mÃ¡s niÃ±as en ingenierÃ­a."
        }
      ]
    },
    {
      id: "m3",
      initials: "RP",
      name: "Rescate y adopciÃ³n de perritos",
      short: "Monterrey Â· Fines de semana",
      meta: "Monterrey Â· Presencial Â· Cuidado animal Â· 14 lugares",
      rating: 4.7,
      ratingCount: 22,
      image: "rescate-perritos.png",
      requirements: [
        "Amor por los animales.",
        "No tener alergias fuertes a pelo de mascotas.",
        "Compromiso con los horarios del refugio."
      ],
      description:
        "ApoyarÃ¡s en la limpieza de Ã¡reas, paseos y eventos de adopciÃ³n para perritos rescatados.",
      notes:
        "Ideal si amas a los perritos y quieres un voluntariado emocionalmente bonito.",
      summary:
        "Las reseÃ±as dicen que terminas lleno de pelosâ€¦ pero tambiÃ©n de amor.",
      reviews: [
        {
          initial: "J",
          name: "Juan Â· Finanzas",
          ratingText: "â˜…â˜…â˜…â˜…â˜† Â· 4.6",
          text: "Te encariÃ±as muchÃ­simo, pero vale la pena todo el trabajo."
        }
      ]
    }
  ],

  "Guadalajara": [
    {
      id: "g1",
      initials: "TI",
      name: "Talleres de inglÃ©s para niÃ±as",
      short: "Guadalajara Â· Fines de semana",
      meta: "Guadalajara Â· Presencial Â· Idiomas Â· 12 lugares",
      rating: 4.8,
      ratingCount: 15,
      image: "ingles-ninas.png",
      requirements: [
        "Nivel intermedio de inglÃ©s (B1 mÃ­nimo).",
        "Habilidad para hablar frente a grupo.",
        "Compromiso de asistir al menos 5 sesiones."
      ],
      description:
        "ImpartirÃ¡s talleres bÃ¡sicos de inglÃ©s a niÃ±as de primaria con dinÃ¡micas de juego y conversaciÃ³n.",
      notes:
        "Actividad perfecta si quieres practicar tu inglÃ©s y enseÃ±ar al mismo tiempo.",
      summary:
        "ReseÃ±as destacan que las niÃ±as participan mucho y pierden el miedo a hablar inglÃ©s.",
      reviews: [
        {
          initial: "I",
          name: "Itzel Â· Lenguas Modernas",
          ratingText: "â˜…â˜…â˜…â˜…â˜… Â· 5.0",
          text: "Se vuelve el momento favorito de la semana. Muy lindo ver cÃ³mo avanzan."
        }
      ]
    },
    {
      id: "g2",
      initials: "HA",
      name: "Apoyo en hogar de ancianos",
      short: "Guadalajara Â· Domingos Â· 3 hrs",
      meta: "Guadalajara Â· Presencial Â· AcompaÃ±amiento Â· 10 lugares",
      rating: 4.7,
      ratingCount: 19,
      image: "hogar-ancianos.png",
      requirements: [
        "Respeto y empatÃ­a hacia adultos mayores.",
        "Escucha activa y paciencia.",
        "Seguir lineamientos del personal mÃ©dico."
      ],
      description:
        "AcompaÃ±arÃ¡s a residentes de un hogar de ancianos en actividades lÃºdicas, plÃ¡ticas y apoyo ligero.",
      notes:
        "Es una experiencia emocionalmente intensa pero muy significativa.",
      summary:
        "Los comentarios mencionan que se crean lazos muy bonitos con los abuelitos.",
      reviews: [
        {
          initial: "P",
          name: "Paola Â· Medicina",
          ratingText: "â˜…â˜…â˜…â˜…â˜† Â· 4.5",
          text: "Te encariÃ±as mucho, aprendes a valorar el tiempo con tu propia familia."
        }
      ]
    },
    {
      id: "g3",
      initials: "FC",
      name: "Festival cultural comunitario",
      short: "Guadalajara Â· Evento especial",
      meta: "Guadalajara Â· Presencial Â· OrganizaciÃ³n de eventos Â· 25 lugares",
      rating: 4.6,
      ratingCount: 12,
      image: "festival-comunitario.png",
      requirements: [
        "Disponibilidad el fin de semana del evento.",
        "Gusto por la organizaciÃ³n y logÃ­stica.",
        "Asistir a 2 juntas previas de planeaciÃ³n."
      ],
      description:
        "ApoyarÃ¡s en la logÃ­stica, montaje y actividades del festival cultural de la comunidad: mÃºsica, danza y talleres.",
      notes:
        "Ideal si te gustan los eventos y el trabajo en equipo.",
      summary:
        "ReseÃ±as resaltan el ambiente festivo y la sensaciÃ³n de logro al ver todo armado.",
      reviews: [
        {
          initial: "C",
          name: "Carlos Â· Mercadotecnia",
          ratingText: "â˜…â˜…â˜…â˜…â˜† Â· 4.4",
          text: "AprendÃ­ muchÃ­simo de eventos. AcabÃ© cansadÃ­simo pero feliz."
        }
      ]
    }
  ]
};

    // ===== ESTADO Y REFERENCIAS =====
    let currentCity = "Puebla";
    let currentOpportunityId = null;

    const cityPills = document.querySelectorAll(".city-pill");
    const opportunityList = document.getElementById("opportunity-list");

    const volTitle = document.getElementById("vol-title");
    const volMeta = document.getElementById("vol-meta");
    const volRatingStars = document.getElementById("vol-rating-stars");
    const volRatingScore = document.getElementById("vol-rating-score");
    const volRatingCount = document.getElementById("vol-rating-count");
    const volImage = document.getElementById("vol-image");
    const volReqList = document.getElementById("vol-requirements");
    const volDescription = document.getElementById("vol-description");
    const volNotes = document.getElementById("vol-notes");
    const volSummary = document.getElementById("vol-summary");
    const volComments = document.getElementById("vol-comments");
    const searchInput = document.getElementById("search-input");
    const commentForm = document.getElementById("comment-form");

    function getStars(rating) {
      const rounded = Math.round(rating);
      let stars = "";
      for (let i = 0; i < 5; i++) {
        stars += i < rounded ? "â˜…" : "â˜†";
      }
      return stars;
    }

    function renderOpportunities(city, filterText = "") {
      const opportunities = volunteerData[city] || [];
      opportunityList.innerHTML = "";

      opportunities.forEach((op) => {
        if (
          filterText &&
          !op.name.toLowerCase().includes(filterText.toLowerCase())
        ) {
          return;
        }

        const btn = document.createElement("button");
        btn.className = "friend-item volunteer-opportunity";
        btn.dataset.id = op.id;

        btn.innerHTML = `
          <div class="friend-avatar">${op.initials}</div>
          <div class="friend-info">
            <div class="friend-name">${op.name}</div>
            <div class="friend-detail">${op.short}</div>
          </div>
        `;

        btn.addEventListener("click", () => {
          setActiveOpportunity(op.id);
        });

        opportunityList.appendChild(btn);
      });

      // Seleccionar la primera oportunidad visible
      const firstBtn = opportunityList.querySelector(".friend-item");
      if (firstBtn) {
        setActiveOpportunity(firstBtn.dataset.id);
      } else {
        // Si no hay resultados por bÃºsqueda
        currentOpportunityId = null;
      }
    }

    function setActiveOpportunity(id) {
      currentOpportunityId = id;

      const opportunities = volunteerData[currentCity] || [];
      const op = opportunities.find((o) => o.id === id);
      if (!op) return;

      // Actualizar estado visual lista
      opportunityList
        .querySelectorAll(".friend-item")
        .forEach((item) =>
          item.classList.remove("volunteer-opportunity--active")
        );
      const activeBtn = opportunityList.querySelector(
        `.friend-item[data-id="${id}"]`
      );
      if (activeBtn) {
        activeBtn.classList.add("volunteer-opportunity--active");
      }

      // Actualizar detalle central
      volTitle.textContent = op.name;
      volMeta.textContent = op.meta;
      volRatingScore.textContent = op.rating.toFixed(1);
      volRatingCount.textContent = `Â· ${op.ratingCount} reseÃ±as`;
      volRatingStars.textContent = getStars(op.rating);

      if (op.image) {
        volImage.src = op.image;
        volImage.alt = `Imagen de ${op.name}`;
      }

      volReqList.innerHTML = "";
      op.requirements.forEach((req) => {
        const li = document.createElement("li");
        li.innerHTML = `
          <span class="check-icon">âœ“</span>
          ${req}
        `;
        volReqList.appendChild(li);
      });

      volDescription.textContent = op.description;
      volNotes.textContent = op.notes;
      volSummary.textContent = op.summary;

      // ReseÃ±as
      volComments.innerHTML = "";
      op.reviews.forEach((rev) => {
        const article = document.createElement("article");
        article.className = "vol-comment";
        article.innerHTML = `
          <div class="vol-comment-header">
            <div class="vol-comment-avatar">${rev.initial}</div>
            <div class="vol-comment-meta">
              <div class="vol-comment-name">${rev.name}</div>
              <div class="vol-comment-rating">${rev.ratingText}</div>
            </div>
          </div>
          <p class="vol-comment-text">${rev.text}</p>
        `;
        volComments.appendChild(article);
      });
    }

    function setCity(city) {
      currentCity = city;

      cityPills.forEach((pill) =>
        pill.classList.toggle(
          "city-pill--active",
          pill.dataset.city === city
        )
      );

      const filterText = searchInput.value.trim();
      renderOpportunities(city, filterText);
    }

    // ===== EVENTOS =====
    cityPills.forEach((pill) => {
      pill.addEventListener("click", () => {
        setCity(pill.dataset.city);
      });
    });

    searchInput.addEventListener("input", () => {
      const text = searchInput.value.trim();
      renderOpportunities(currentCity, text);
    });

    // Dropdown de community (igual que en foro)
    const toggle = document.getElementById("community-toggle");
    const group = document.getElementById("community-group");
    if (toggle && group) {
      toggle.addEventListener("click", () => {
        group.classList.toggle("nav-sub--open");
      });
    }

    // Formulario de reseÃ±a (solo prevenir que recargue)
    if (commentForm) {
      commentForm.addEventListener("submit", (e) => {
        e.preventDefault();
        // AquÃ­ podrÃ­as agregar lÃ³gica para guardar la reseÃ±a si despuÃ©s conectan backend
        commentForm.reset();
        alert("Gracias por tu reseÃ±a ğŸ’™");
      });
    }

    // Inicializar (Puebla por default)
    setCity("Puebla");
  </script>
</body>
</html>
